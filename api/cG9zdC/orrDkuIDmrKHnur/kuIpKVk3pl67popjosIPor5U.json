{"title":"记一次线上JVM问题调试","date":"2019-02-27T03:21:32.000Z","slug":"记一次线上JVM问题调试","comments":true,"tags":["JVM问题调试"],"categories":["JVM"],"updated":"2019-02-27T04:14:47.590Z","content":"<h3 id=\"发现java进程\">发现java进程<a href=\"post/记一次线上JVM问题调试#发现java进程\"></a></h3><ul>\n<li>使用linux命令：ps</li>\n</ul>\n<pre><code>ps -ef | grep prcessName\n[root@YZSJHL81-35 ~]# ps -ef | grep Bootstrap\nroot     118271      1 99 00:10 ?        3-16:08:07  Bootstrap start\nroot     197682 197016  0 17:08 pts/0    00:00:00 grep Bootstrap\n</code></pre><ul>\n<li>使用java自带的检测工具 jps</li>\n</ul>\n<pre><code>[root@YZSJHL81-35 ~]# jps\n118271 Bootstrap\n197101 Jps\n</code></pre><a id=\"more\"></a>\n<ul>\n<li>检测java进程启动的时间</li>\n</ul>\n<pre><code>ps -p 118271 -o etime\nps -p 118271 -o etime=\n</code></pre><ul>\n<li>检测进程打开的文件数</li>\n</ul>\n<pre><code>lsof -n -p 118271 | wc -l\n</code></pre><h3 id=\"检测系统的进程\">检测系统的进程<a href=\"post/记一次线上JVM问题调试#检测系统的进程\"></a></h3><ul>\n<li>top</li>\n</ul>\n<pre><code>top - 17:11:21 up 132 days,  2:14,  1 user,  load average: 0.12, 0.21, 0.18\nTasks: 298 total,   1 running, 297 sleeping,   0 stopped,   0 zombie\nCpu(s):  1.0%us,  0.6%sy,  0.0%ni, 98.0%id,  0.3%wa,  0.0%hi,  0.1%si,  0.0%st\nMem:  99009860k total, 90554384k used,  8455476k free,   333672k buffers\nSwap:        0k total,        0k used,        0k free, 81820024k cached\n\nPID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND\n\nq-退出\n1-显示所有的cpu及其状态\n</code></pre><ul>\n<li>查看指定进程下所有线程的状态</li>\n</ul>\n<pre><code>top -Hp pid\n</code></pre><h3 id=\"查看JVM的GC状态\">查看JVM的GC状态<a href=\"post/记一次线上JVM问题调试#查看JVM的GC状态\"></a></h3><pre><code>jstat -gcutil -t pid 1000 100 ---查看pid进程的GC状态每隔1000ms一次，一共100次\n</code></pre><p>​    </p>\n<h3 id=\"查看JVM栈信息\">查看JVM栈信息<a href=\"post/记一次线上JVM问题调试#查看JVM栈信息\"></a></h3><pre><code>printf &apos;%x\\n&apos; tid -- 打印指定线程id的十六进制表示\njstack pid | grep &apos;tid十六进制&apos; -C20 -color  -- 查看进程的栈信息\njmap -histo:live pid --查看进程所有存活的实例\njmap -dumap:format=b,file=dump.hprof pid --导出JVM的dump文件\n</code></pre>","next":{"title":"辨析 Sass 中的 Map 和 List","slug":"demo"},"link":"https://ws2823147532.github.io/ws-site/post/记一次线上JVM问题调试/"}